#  Akamai Scripts
Scripts to help debug problems with DP/Akamai interactions

## formatesi.pl
A perl script that formats ESI XML.
* Usage
```
curl -k -H "Accept-ESI: 1" -XGET "https://west.origin-svc.westelm.com/shop/rugs/all-rugs/" | formatesi
```

## esishell
A shell script that curls a DP URL and retrieves the ESI script generated by DP to be passed back to Akamai.
The "Accept-ESI" header is attached to this request to cause the AkamaiShellIntercepter.java code to execute.

* Usage
  * esishell DP-URL
  * esishell https://localhost:8466/promotion/leather-sunday-golf-shoe-bag/eligiblePromotions.json

## esipage
A shell script that curls a DP URL with the "ekey=1" URL parameter to retrive a page's embedded ESI script.

* Usage
  * esipage DP-URL
  * esipage https://localhost:8466/promotion/leather-sunday-golf-shoe-bag/eligiblePromotions.json

References:
* https://confluence.wsgc.com/pages/viewpage.action?pageId=40341286
* https://confluence.wsgc.com/display/EE/Akamai+as+the+Content+Delivery+Network
* https://confluence.wsgc.com/display/PS/Howto+Troubleshoot+ESI+issues
* https://confluence.wsgc.com/display/CT/Akamai+and+ESI+,and+then+AB+test
* https://confluence.wsgc.com/display/CT/Akamai+and+ESI+,and+then+AB+test#AkamaiandESI,andthenABtest-HowtogetthegeneratedESIcodefromAkamaiInterceptorclassonlocallyrunningeComsite
